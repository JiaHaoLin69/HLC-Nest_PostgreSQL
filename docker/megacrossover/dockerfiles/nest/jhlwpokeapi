FROM jiahaolin69/nginx

# Instalar Node.js 22
RUN apt-get update && apt-get install -y curl gnupg software-properties-common
RUN apt-get install -y curl ca-certificates gnupg 
RUN curl -fsSL https://deb.nodesource.com/setup_22.x | bash -
RUN apt-get install -y nodejs
RUN apt-get clean
RUN rm -rf /var/lib/apt/lists/*
RUN node --version && npm --version

# Crear directorio para el proyecto NestJS
RUN mkdir -p /root/admin/node/proyectos/nestpostgresql
WORKDIR /root/admin/node

# Copiar el proyecto NestJS compilado
COPY ./proyecto/nest_api/proyecto/ /root/admin/node/proyectos/nestpostgresql/

# Copiar el script de entrypoint
COPY ./dockerfiles/nest/admin/jhlwstart.sh .
RUN chmod +x /root/admin/node/jhlwstart.sh

ENTRYPOINT [ "./jhlwstart.sh" ]