FROM jiahaolin/ubseguridad

USER root

# Instalar PostgreSQL 15
RUN apt-get update && apt-get install -y --no-install-recommends \
    postgresql-15 \
    postgresql-client-15 \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Crear directorio de datos y asignar permisos
RUN mkdir -p /var/lib/postgresql/data && \
    chown -R postgres:postgres /var/lib/postgresql/data

# Crear directorio admin para el entrypoint
RUN mkdir -p /root/admin/postgre
WORKDIR /root/admin/postgre
COPY ./dockerfiles/postgre/admin/jhlwstart.sh .
RUN chmod +x ./jhlwstart.sh

EXPOSE 5432

ENTRYPOINT ["./jhlwstart.sh"]
